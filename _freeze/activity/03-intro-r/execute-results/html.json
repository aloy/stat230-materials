{
  "hash": "ff79e4abfeed512d9ccc98a980ec5a5a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Introduction to R for Stat 230\"\nwebr:\n  packages:\n    - dplyr\n    - ggformula\nformat: \n  live-html:\n    toc: true\nengine: knitr\neditor: source\n---\n\n\n::: {.cell}\n\n:::\n\n\n\n## Overview\n\nIn Stat 230 we will use the R statistical programming language to visualize our data and fit our regression models. Many of you have seen R before, but if you are coming straight from AP statistics this might be your first time using R. Today our goal it to learn the basics of writing and running code in R. To do this, we’ll run our code in a tutorial webpage. Next class I’ll introduce you to the RStudio server and how to create R Markdown files.\n\n## Loading data\n\nToday we will work with the `movies` data set. The data set contains the critic's score and the audience score for movie released in 2014-2015. The critic's score is the percentage of critics who had a favorable view of the movie. Similarly, the audience score is the percentage of users who had a favorable view of the movie. Today, you'll explore the relationship between the audience and critic scores.\n\nTo load data into R, we use the `read.csv()` command and pass in either a file path or URL in quotes. Below, the data are being loaded from the web. Click \"Run code\" to load the data.\n\n\n::: {.cell}\n```{webr}\nmovies <- read.csv(\"https://aloy.github.io/stat230-materials/data/movie_scores.csv\")\n```\n:::\n\n\nNotice that we use parentheses with functions and place the arguments for that function inside those parentheses.\n\n::: callout-note\nYou should notice that R did not *appear* to do anything when you ran the above code. That's because everything was done in the background and R will only show you what is requested. So don't panic if you don't see any output!\n:::\n\n## Getting a glimpse of the data set\n\nThroughout the term I'll refer to small pieces of code as \"code chunks.\" This is both descriptive and will be what RStudio (our interface) calls them later on. For today, we'll focus on how to write small code chunks to accomplish specific tasks for simple linear regression.\n\nFor example, we might wish to get an overview of the data set by printing the first few rows via `head()`\n\n\n::: {.cell}\n```{webr}\nhead(movies)\n```\n:::\n\n\nI prefer to use a different function, `glimpse()`, which is in the {dplyr} package. To load a package we first must run the `library()` command. The below code chunk loads this package and gives a \"glimpse\" of the `movies` data set:\n\n\n::: {.cell}\n```{webr}\nlibrary(dplyr)\nglimpse(movies)\n```\n:::\n\n\n### Checkpoint questions:\n\nUsing the output from the above code chunk, answer the following questions in the code box below:\n\n-   How many rows are in the `movies` data set?\n-   How many variables are in the `movies` data set? Are any categorical? Are any quantitative?\n\n\n## Univariate exploration\n\nBefore jumping into a regression model, it can be useful to understand more about each variable. This can be accomplished using intro stat tools such as histograms and summary statistics. \n\nThe fastest way to get started is using the `summary()` function, which returns a brief set of summary statistics for each variable in the data set.\n\n\n::: {.cell}\n```{webr}\nsummary(movies)\n```\n:::\n\n\nR also has built-in functions to compute summary statistics one by one for a specific column. To \"extract\" a variable from the data set, we use a `$`. For example, we can extract the `critics` column from the `movies` data frame and calculate the standard deviation:\n\n\n::: {.cell}\n```{webr}\nsd(movies$critics)\n```\n:::\n\n\nOther useful summary statistics for quantitative variables include (here `x` denotes an extracted column):\n\n| Function | Summary statistic|\n|----|-----------|\n| `median(x)` | median |\n| `mean(x)` | mean |\n| `var(x)` | variance |\n| `IQR(x)` | interquartile range |\n\n<br>\n\nTo create graphics in this course we'll use tools from the {ggformula} R package. All of the functions will begin with `gf_` and have similar syntax. If you're familiar with the {ggplot2} package, feel free to use it for this class, but most students like the \"one-liners\" that {ggformula} allows.\n\nTo begin, load the {ggformula} package using the library command:\n\n\n::: {.cell}\n```{webr}\nlibrary(ggformula)\n```\n:::\n\n\nFor example, to create a histogram of the critic's score we can run\n\n\n::: {.cell}\n```{webr}\ngf_histogram(~critics, data = movies, bins = 10)\n```\n:::\n\n\nHere we use the `~` to tell R that `critics` is a variable in the data set. We must also specify `data` and adjust the number of `bins` as needed.\n\nSimilar syntax is used to create a boxplot\n\n\n::: {.cell}\n```{webr}\ngf_boxplot(~critics, data = movies)\n```\n:::\n\n\n\n### Checkpoint questions\n\nUse the below code box for the checkpoint questions:\n\n\n::: {.cell min-lines='5'}\n```{webr}\n#| min-lines: 5\n```\n:::\n\n\n\n* Calculate the mean audience score using the `mean()` function.\n* Create a histogram of the `audience` score and describe what you see.\n* Change the number of bins for a histogram of `audience`. What number of bins seems \"about right\" in your opinion?\n\n\n##  Bivariate exploration\n\n### Scatterplots\n\nIn this course we are interested in exploring relationships between variables. If we have two quantitative variables, then a scatterplot is a natural way to visually explore this relationship. To create a scatterplot we can use the `gf_point()` function (since scatterplots are just points):\n\n\n::: {.cell}\n```{webr}\ngf_point(audience ~ critics, data = movies)\n```\n:::\n\n\nNotice that we put the response variable on the left of the `~` and the explanatory variable on the right.\n\n\n#### Checkpoint questions\n\nUse the below code box for the checkpoint questions:\n\n\n::: {.cell min-lines='5'}\n```{webr}\n#| min-lines: 5\n```\n:::\n\n\n* Create a scatterplot where `critics` score is the response variable and `audience` score is the explanatory variable.\n* You can adjust the axis labels by adding an `xlab` or `ylab` argument. Add `xlab = \"Your axis label\"` and `ylab = \"Your other axis label\"` to your scatterplot and give more verbose axis labels.\n\n\n### Scatterplots with regression lines\n\nYou can also add a simple linear regression line to your scatterplot by adding a **layer**. To add a layer, we append the `|>` pipe operator to the end of our `gf_point()` code and use the `gf_lm()` command to add a line:\n\n\n::: {.cell}\n```{webr}\ngf_point(audience ~ critics, data = movies) |>\n  gf_lm()\n```\n:::\n\n\n\n### Correlation\n\nIf you want a numeric summary of the strength of the linear association between two quantitative variables, then you can calculate the correlation. In R, you do this using the `cor()` function. Similar to calculating the mean, you need to extract the columns using `$` as shown below:\n\n\n::: {.cell}\n```{webr}\ncor(movies$audience, movies$critics)\n```\n:::\n\n\n#### Checkpoint questions\n\nUse the below code box for the checkpoint question:\n\n\n::: {.cell min-lines='5'}\n```{webr}\n#| min-lines: 5\n```\n:::\n\n\n* Swap the order of the variables in the `cor()` command. Does the correlation change? Is this what you expected?\n\n\n## Fitting a regression model\n\nFinally, lets fit a simple linear regression model. To do this we use the `lm()` command (which stands for linear model). Here, we use the same syntax as when creating a scatterplot:\n\n\n::: {.cell}\n```{webr}\nlm(audience ~ critics, data = movies)\n```\n:::\n\n\nWhen you run this command, R prints some very basic information about the SLR model.\n\n**Checkpoint:** What information do you get when you run the above command?\n\nOften, you will want to obtain more information than you get from simply printing the fitted model. The `summary()` function provides much more information. I recommend storing your fitted model as a named object (such as `movie_lm`) and then running the `summary()`:\n\n\n::: {.cell}\n```{webr}\nmovie_lm <- lm(audience ~ critics, data = movies)\nsummary(movie_lm)\n```\n:::\n\n\n**Checkpoint**: What information do you get when you run the above `summary()` command? If you're not sure what something means, discuss it with your group and then ask about it in our debrief.\n\n\n\n## Making predictions\n\nTo make predictions, we use our fitted regression equation.\nWhile you can (and should be able to) do this by hand, you can also use R as your calculator. \n\nSuppose we can use our model to predict the audience score for more recent movies. Then we could predict the audience score for the Barbie Movie by running:\n\n\n::: {.cell}\n```{webr}\nbarbie_movie <- data.frame(critics = 88)\npredict(movie_lm, newdata = barbie_movie)\n```\n:::\n\n\nHere, we first need to create a new data set with a column named identically to the original data set. Here we have a single column named `critics` with the value of the explanatory variable we want to use. Next, we use the `predict()` function, passing in the name of our model and the new data set we want to make predictions for.\n\n### Checkpoint questions\n\nUse the below code box for the checkpoint questions:\n\n\n::: {.cell min-lines='5'}\n```{webr}\n#| min-lines: 5\n```\n:::\n\n\n\n* The critics score for Asteroid City was 75. What is the expected audience score for this movie?\n* The actual (observed) value  for Asteroid City was 62. Did the mode over- or under-predict the audience score?\n* Do you think it's reasonable to use our model to predict the audience score for movies released in 2023? Why or why not?\n\n\n### Making multiple predictions\n\nIf you want to make multiple predictions, then you can create a new data frame with multiple values for the explanatory variable. For example, we can use `c(88, 75)` to make a data frame with two values in the critics column:\n\n\n::: {.cell}\n```{webr}\nnew_movies <- data.frame(critics = c(88, 75))\npredict(movie_lm, newdata = new_movies)\n```\n:::\n\n\n***\n\n## Function quick reference\n\nThe following table summarizes the functions we learned today:\n\n| Function | Purpose |\n|----|-----------|\n| `read.csv(\"file_path_or_URL\")` | Load a CSV data set from a file or the web |\n| `head(data)` | Print the first few rows of a data set |\n| `glimpse(data)` | Get a quick overview of a data set (from {dplyr} package) |\n| `summary(data)` | Get summary statistics for each variable in a data set |\n| `mean(x)` | Calculate the mean of a quantitative variable |\n| `median(x)` | Calculate the median of a quantitative variable |\n| `sd(x)` | Calculate the standard deviation of a quantitative variable |\n| `var(x)` | Calculate the variance of a quantitative variable |\n| `gf_histogram(~x, data = data, bins = n)` | Create a histogram of a quantitative variable (from {ggformula} package) |\n| `gf_boxplot(~x, data = data)` | Create a boxplot of a quantitative variable (from {ggformula} package) |\n| `gf_point(y ~ x, data = data)` | Create a scatterplot of two quantitative variables (from {ggformula} package) |\n| `gf_lm()` | Add a simple linear regression line to a scatterplot (from {ggformula} package) |\n| `cor(x, y)` | Calculate the correlation between two quantitative variables |\n| `lm(y ~ x, data = data)` | Fit a simple linear regression model |\n| `summary(model)` | Get detailed information about a fitted regression model |\n| `predict(model, newdata = new_data)` | Make predictions using a fitted regression model for new data |\n\n\n***\n\n## Acknowledgements\n\nThe movie example was adapted from Maria Tackett's draft of *Introduction to Regression Analysis: A Data Science Approach*.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
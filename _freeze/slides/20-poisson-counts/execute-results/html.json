{
  "hash": "9b08bdfbe939e7e06d347a5fee4e660a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Modeling Counts\"\nsubtitle: \"Poisson regression -- Stat 230\"\nformat: \n  revealjs:\n    chalkboard: \n      buttons: false\neditor: source\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\n## Puffin nesting\n\n**Goal:** describe the nesting frequency of the common puffin in a 3m &#215; 3m grid of plots.\n\n<br>\n\n::: {style=\"font-size: 33px\"}\nVariable | Description\n---------|--------------------\n`nests`  | number of nests (burrows) per 9 m<sup>2</sup> quadrat\n`grass`    | grass cover percentage\n`soil`     | mean soil depth in cm\n`angle`    | angle of slope in degrees\n`distance` | distance from cliff edge in meters\n:::\n\n::: {.footer style=\"text-align: left; margin-left: 50px\"}\nSource: Nettleship, D. N. (1972). Breeding success of the Common Puffin (Fratercula arctica L.) on different habitats at Great Island, Newfoundland. *Ecological Monographs*, 42(2), 239-268.\n:::\n\n---\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](20-poisson-counts_files/figure-revealjs/unnamed-chunk-1-1.svg){fig-align='center' width=100%}\n:::\n:::\n\n\n---\n\n## Initial model\n\nFirst, consider the association between the number of nests and the  distance from the cliff edge \n\n**Which version of `Nests` would you prefer to use in a linear model?**\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](20-poisson-counts_files/figure-revealjs/unnamed-chunk-2-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n---\n\n## SLR model\n\nIf we wanted to use an SLR model, then we could consider the square-root transformation of the response\n\n\n$$\\mu \\lbrace \\sqrt{{\\tt nests}} | {\\tt distance} \\rbrace = \\beta_0 + \\beta_1 {\\tt distance}$$\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 4.6313 </td>\n   <td style=\"text-align:right;\"> 0.2114 </td>\n   <td style=\"text-align:right;\"> 21.9123 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> distance </td>\n   <td style=\"text-align:right;\"> -0.0634 </td>\n   <td style=\"text-align:right;\"> 0.0090 </td>\n   <td style=\"text-align:right;\"> -7.0167 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n. . .\n\n**The diagnostics check out, so why might we prefer a different model?**\n\n\n## Linear regression\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](20-poisson-counts_files/figure-revealjs/unnamed-chunk-4-1.svg){fig-align='center' width=576}\n:::\n:::\n\n\n## Poisson regression\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](20-poisson-counts_files/figure-revealjs/unnamed-chunk-5-1.svg){fig-align='center' width=576}\n:::\n:::\n\n\n\n\n\n## Generalized linear model\n\n::: {.fragment fragment-index=1}\n**Random component: **\n:::\n\n::: {.fragment fragment-index=2}\nWhat distribution does the response variable follow?\n:::\n\n<br>\n\n\n::: {.fragment fragment-index=1}\n**Linear predictor (systematic component): **\n:::\n\n::: {.fragment fragment-index=3}\nWhat function of the predictors should we use?\n:::\n\n<br>\n\n\n::: {.fragment fragment-index=1}\n**Link function: **\n:::\n\n::: {.fragment fragment-index=4}\nHow can we relate the expectation of $Y$ and our linear predictor?\n:::\n\n\n## Random component\n\nWhat distribution does the response variable follow?\n\n<br>\n\n**Possible values:** We are counting the number of events that occur over a fixed interval, so $Y =0, 1, 2, \\ldots$\n\n<br>\n\n**Poisson distribution**\n\n$P(Y = y) = \\frac{e^{-\\lambda} \\lambda^y}{y!}, \\quad \\text{for} \\quad y = 0, 2, 1, \\ldots$\n\n\n\n## Linear predictor\n\nWhat function of the predictors should we use?\n\n<br>\n\n$\\eta = \\beta_0 + \\beta_1 X_1 + \\cdots + \\beta_p X_p$\n\n:::{.aside}\n$\\eta =$ \"eta\"\n:::\n\n\n## Link function\n\nHow can we relate the expectation of $Y$ and our linear predictor?\n\n. . .\n\n<br>\n\n$E(Y) = \\lambda$ between 0 and $\\infty$\n\n<br>\n\n$\\eta = \\beta_0 + \\beta_1 X_1 + \\cdots + \\beta_p X_p \\longrightarrow$ between $-\\infty$ and $\\infty$\n\n<br>\n\nWhat function takes numbers between between 0 and $\\infty$ as input and maps them to the real line?\n\n\n## Link function\n\nHow can we relate the expectation of $Y$ and our linear predictor?\n\n\n$\\log(\\lambda) = \\beta_0 + \\beta_1 X_1 + \\cdots + \\beta_p X_p = \\eta$\n\n\n\n\n---\n\n## Poisson regression model for counts\n\n**Random component:** $Y_i = \\#$ nests in a 9 m<sup>2</sup> quadrat; Poisson distribution is reasonable\n\n. . .\n\n<br>\n\n**Link function:** $E(Y) = \\lambda$ and $\\lambda >0$\n\n$\\Longrightarrow \\log(\\lambda) = \\beta_0 + \\beta_1 X_1 + \\cdots + \\beta_p X_p = \\eta$\n\n. . .\n\n<br>\n\n**Inverse-link function:** $E(Y) = e^{\\beta_0 + \\beta_1 X_1 + \\cdots + \\beta_p X_p}$\n\n\n\n\n---\n\n## EDA\n\n:::: {.columns}\n\n::: {.column width=\"60%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](20-poisson-counts_files/figure-revealjs/unnamed-chunk-6-1.svg){width=100%}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"40%\"}\n\n<!-- - Why did we use <br> `log(nests + 0.5)`? -->\n\nWhat structure are we looking for in this plot?\n\n<br>\n\n<br>\n\n\nThere are no 0 counts in this data set, how could we create this plot if we had observed 0s?\n\n:::\n\n::::\n\n---\n\n## Model fitting\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglm(nests ~ distance, data = puffin, family = poisson)\n```\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)\n(Intercept)  3.12797    0.11049  28.311  < 2e-16\ndistance    -0.03585    0.00562  -6.378 1.79e-10\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 65.900  on 24  degrees of freedom\nResidual deviance: 23.653  on 23  degrees of freedom\n```\n:::\n\n\n<br>\n\n**Fitted model:** $\\log(\\widehat{\\lambda}) = 3.128 -0.036{\\tt distance}$\n\n. . .\n\n**How can we interpret the coefficients?**\n\n\n---\n\n## Multiple predictors\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfull <- glm(nests ~ grass + soil + angle + distance, data = puffin,\n            family = poisson)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCoefficients:\n              Estimate Std. Error z value Pr(>|z|) \n(Intercept)  2.1202963  0.4733672   4.479 7.49e-06 \ngrass       -0.0006591  0.0032590  -0.202   0.8397 \nsoil         0.0190915  0.0109412   1.745   0.0810 \nangle        0.0078423  0.0128681   0.609   0.5422 \ndistance    -0.0269270  0.0152854  -1.762   0.0781 \n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 65.900  on 24  degrees of freedom\nResidual deviance: 16.944  on 20  degrees of freedom\n```\n:::\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
{
  "hash": "b0f9ad5ec0b40355aa68f319179e5bb8",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Modeling a Binary Response\"\nsubtitle: \"Logistic regression -- Stat 230\"\nformat: \n  revealjs:\n    chalkboard: \n      buttons: false\neditor: source\n---\n\n\n\n## Framingham Heart Study {.smaller}\n\n- Long-term study of cardiovascular disease (heart attack, stroke, and other heart problems) \n\n- First study of cardiovascular disease to follow initially healthy people over a long period of time\n\n- Identified the idea that body measurements (blood pressure, cholesterol, etc) could predict cardiovascular disease.\n\n- Participants from a population of free living (not hospitalized) subjects in the community of Framingham, Mass.\n\n- Started in 1948, participants have been examined every other year since the inception\n\n- In 3rd generation of participants!\n\n\n## Modeling overview\n\n**Goal:** Determine whether participant experienced coronary heart disease (CHD) in 10-year window after their exam\n\n- Y = CHD (0 = no, 1 = yes)\n\n- X = participant's age, sex, total cholesterol, and systolic blood pressure\n\n**Strategy:** model the probability of CHD given these factors\n\n\n\n\n## How can we model a binary response?\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n\n:::{.fragment}\n\n::: {style=\"text-align: center;\"}\n**Linear regression**\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](14-binary-logistic_files/figure-revealjs/unnamed-chunk-1-1.png){fig-align='center' width=100%}\n:::\n:::\n\n:::\n\n:::\n\n\n::: {.column width=\"50%\"}\n\n\n:::{.fragment}\n\n::: {style=\"text-align: center;\"}\n**Logistic regression**\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](14-binary-logistic_files/figure-revealjs/unnamed-chunk-2-1.png){fig-align='center' width=100%}\n:::\n:::\n\n:::\n\n:::\n\n::::\n\n\n## Generalized linear model\n\n::: {.fragment fragment-index=1}\n**Random component: **\n:::\n\n::: {.fragment fragment-index=2}\nWhat distribution does the response variable follow?\n:::\n\n<br>\n\n\n::: {.fragment fragment-index=1}\n**Linear predictor (systematic component): **\n:::\n\n::: {.fragment fragment-index=3}\nWhat function of the predictors should we use?\n:::\n\n<br>\n\n\n::: {.fragment fragment-index=1}\n**Link function: **\n:::\n\n::: {.fragment fragment-index=4}\nHow can we relate the expectation of $Y$ and our linear predictor?\n:::\n\n\n## Random component\n\nWhat distribution does the response variable follow?\n\n<br>\n\n**Possible values:** $Y = 0 \\text{ or } 1$\n\n<br>\n\n**Bernoulli distribution**\n\n$P(Y = y) = \\pi^y (1-\\pi)^{1-y}, \\ y=0,1$\n\n\n\n## Linear predictor\n\nWhat function of the predictors should we use?\n\n<br>\n\n$\\eta = \\beta_0 + \\beta_1 X_1 + \\cdots + \\beta_p X_p$\n\n:::{.aside}\n$\\eta =$ \"eta\"\n:::\n\n\n## Link function\n\nHow can we relate the expectation of $Y$ and our linear predictor?\n\n. . .\n\n<br>\n\n$E(Y) = \\pi \\longrightarrow$ between 0 and 1\n\n<br>\n\n$\\eta = \\beta_0 + \\beta_1 X_1 + \\cdots + \\beta_p X_p \\longrightarrow$ between $-\\infty$ and $\\infty$\n\n<br>\n\nWhat function takes numbers between 0 and 1 as input and maps them to the real line?\n\n\n## The logit function\n\n\n${\\rm logit}(\\pi) = \\log \\left( \\dfrac{\\pi}{1 - \\pi} \\right)$\n\n. . .\n\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](14-binary-logistic_files/figure-revealjs/unnamed-chunk-3-1.png){width=100%}\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](14-binary-logistic_files/figure-revealjs/unnamed-chunk-4-1.png){width=100%}\n:::\n:::\n\n:::\n::::\n\n\n## Link function\n\nHow can we relate the expectation of $Y$ and our linear predictor?\n\n<br>\n\n${\\rm logit}(\\pi) = \\log \\left( \\dfrac{\\pi}{1 - \\pi} \\right) = \\beta_0 + \\beta_1 X_1 + \\cdots + \\beta_p X_p = \\eta$\n\n\n## Example: A quantitative predictor\n\nLet's use total cholesterol as a predictor of CHD\n\n. . .\n\n\n$$\\widehat{\\eta}_i = \\log \\left( \\dfrac{\\widehat{\\pi}(\\mathtt{totChol_i})}{1-\\widehat{\\pi}(\\mathtt{totChol_i})} \\right) = -2.894 + 0.005 \\mathtt{totChol}_i$$\n\n. . .\n\n$\\widehat{\\beta}_1 = 0.005$ is the expected change in the log odds associated with a 1-unit increase in total cholesterol...\n\n<br>\n\n. . . \n\nWe don't think in terms of log odds, so we need more interpretable quantities!\n\n\n## Log odds $\\to$ odds\n\n**Log odds:** \n\n$\\widehat{\\eta} = \\log \\left( \\dfrac{\\widehat{\\pi}(\\mathtt{X})}{1-\\widehat{\\pi}(\\mathtt{X})} \\right) = \\widehat{\\beta}_0 + \\widehat{\\beta}_1 X_1 + \\cdots + \\widehat{\\beta}_p X_p$\n\n<br>\n\n. . .\n\n\n**Odds of success:** \n\n$\\widehat{\\omega} = \\dfrac{\\widehat{\\pi}(\\mathtt{X})}{1-\\widehat{\\pi}(\\mathtt{X})} = e^{\\widehat{\\beta}_0 + \\widehat{\\beta}_1 X_1 + \\cdots + \\widehat{\\beta}_p X_p}$\n\n\n## Example: A quantitative predictor {.smaller}\n\n\n$$\\widehat{\\eta}_i = \\log \\left( \\dfrac{\\widehat{\\pi}(\\mathtt{totChol})}{1-\\widehat{\\pi}(\\mathtt{totChol})} \\right) = -2.894 + 0.005 \\mathtt{totChol}_i$$\n\nHow do we interpret $e^{\\widehat{\\beta}}_1 = e^{0.005} \\approx 1.005$??\n\n. . .\n\n$\\dfrac{\\widehat{\\pi}(\\mathtt{totChol})}{1-\\widehat{\\pi}(\\mathtt{totChol})} = e^{-2.894 + 0.005 \\mathtt{totChol}_i} = e^{-2.894} \\cdot e^{0.005 \\mathtt{totChol}_i}$\n\n. . .\n\nSo if `totChol` increases by one unit...\n\n$\\dfrac{\\widehat{\\pi}(\\mathtt{totChol+1}) / \\lbrace 1-\\widehat{\\pi}(\\mathtt{totChol+1}) \\rbrace}{ \\widehat{\\pi}(\\mathtt{totChol}) / \\lbrace 1-\\widehat{\\pi}(\\mathtt{totChol}) \\rbrace} = \\dfrac{e^{-2.894} \\cdot e^{0.005 \\mathtt{totChol+1}}}{e^{-2.894} \\cdot e^{0.005 \\mathtt{totChol}}}$\n\n. . .\n\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n:::\n\n::: {.column width=\"50%\"}\n$=\\dfrac{e^{-2.894} \\cdot e^{0.005 \\mathtt{totChol}} \\cdot e^{0.005(1)}}{e^{-2.894} \\cdot e^{0.005 \\mathtt{totChol}}}$\n:::\n::::\n\n. . .\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n:::\n\n::: {.column width=\"50%\"}\n$=e^{0.005(1)} \\approx 1.005$\n:::\n::::\n\n. . .\n\nwe expect the odds of CHD to increase by a factor of 1.005\n\n\n## Estimating probabilities\n\nWhat's the probability that a person with total cholesterol of 240 mg/dL will develop CHD in the next 10 years?\n\n. . .\n\n\n$$\\widehat{\\eta}(\\mathtt{240}) = \\log \\left( \\dfrac{\\widehat{\\pi}(\\mathtt{240})}{1-\\widehat{\\pi}(\\mathtt{240})} \\right) = -2.894 + 0.005(\\mathtt{240}) = -1.694$$\n\n. . .\n\n<br>\n\nHow do we get from the estimated log odds to a probability?\n\n\n## Log odds $\\to$ probability {.smaller}\n\n**Log odds:** \n\n$\\widehat{\\eta} = \\log \\left( \\dfrac{\\widehat{\\pi}(\\mathtt{X})}{1-\\widehat{\\pi}(\\mathtt{X})} \\right) = \\widehat{\\beta}_0 + \\widehat{\\beta}_1 X_1 + \\cdots + \\widehat{\\beta}_p X_p$\n\n<br>\n\n\n**Odds of success:** \n\n$\\widehat{\\omega} = \\dfrac{\\widehat{\\pi}(\\mathtt{X})}{1-\\widehat{\\pi}(\\mathtt{X})} = e^{\\widehat{\\beta}_0 + \\widehat{\\beta}_1 X_1 + \\cdots + \\widehat{\\beta}_p X_p}$\n\n<br>\n\n. . .\n\n**Probability of success:** \n\n\n$\\widehat{\\pi}(X) = \\dfrac{e^{\\widehat{\\beta}_0 + \\widehat{\\beta}_1 X_1 + \\cdots + \\widehat{\\beta}_p X_p}}{1+e^{\\widehat{\\beta}_0 + \\widehat{\\beta}_1 X_1 + \\cdots + \\widehat{\\beta}_p X_p}}$\n\n\n## Estimating probabilities\n\nWhat's the probability that a person with total cholesterol of 240 mg/dL will develop CHD in the next 10 years?\n\n\n$$\\widehat{\\eta}(\\mathtt{240}) = \\log \\left( \\dfrac{\\widehat{\\pi}(\\mathtt{240})}{1-\\widehat{\\pi}(\\mathtt{240})} \\right) = -2.894 + 0.005(\\mathtt{240}) = -1.694$$\n\n\nHow do we get from the estimated log odds to a probability?\n\n<br>\n\n. . .\n\n$\\widehat{\\pi}(240) = \\dfrac{e^{-1.694}}{1 + e^{-1.694}} \\approx  0.155$\n\n\n## Fitted logistic regression model\n\n${\\rm logistic}(\\widehat{\\eta}) = \\dfrac{ \\exp(\\widehat{\\eta}) }{ 1+  \\exp(\\widehat{\\eta})}$ is the fitted curve on the probability scale\n\n\n:::: {.columns}\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](14-binary-logistic_files/figure-revealjs/unnamed-chunk-5-1.png){width=80%}\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](14-binary-logistic_files/figure-revealjs/unnamed-chunk-6-1.png){width=80%}\n:::\n:::\n\n:::\n::::\n",
    "supporting": [
      "14-binary-logistic_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
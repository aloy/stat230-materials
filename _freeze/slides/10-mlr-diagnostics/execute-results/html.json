{
  "hash": "8f1b61a3f7a485207e3b2b44cdcb7dab",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Multiple Regression Diagnostics\"\nsubtitle: \"Stat 230: Applied Regression Analysis\"\nformat: \n  revealjs:\n    chalkboard: \n      buttons: false\neditor: source\n---\n\n\n\n## Warm up\n\nWith your group\n\n- List the conditions for MLR\n\n- Brainstorm ways to check these conditions\n\n\n## Regression is *not* resistant to outliers\n\nSolid line = with outliers; dashed line = without outliers\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](10-mlr-diagnostics_files/figure-revealjs/unnamed-chunk-2-1.png){width=384}\n:::\n:::\n\n\n---\n\n## SLR is *not* resistant to outliers\n\n<br>\n\n$$\\widehat{\\beta}_1 = r \\cdot \\dfrac{s_y}{s_x} \\qquad \\qquad \\widehat{\\beta}_0 = \\bar{y} - \\widehat{\\beta}_1 \\bar{x}$$\n\n<br>\n\nWhy?\n\n- $r$ is not resistant\n- $s_y$, $s_x$ are not resistant\n- $\\bar{x}$, $\\bar{y}$ are not resistant\n\n\n## MLR is *not* resistant to outliers\n\nWe're still choosing the $\\widehat{\\beta}_i$ to minimize the sum of squared residuals\n\n$$\n\\begin{split}\nSSE &= \\sum_{i=1}^n \\left( y_i - \\widehat{y}_i \\right)^2\\\\ \n&= \\sum_{i=1}^n \\left( y_i - \\widehat{\\beta}_0 - \\widehat{\\beta}_1 x_{i1} - \\widehat{\\beta}_2 x_{i2} - ... - \\widehat{\\beta}_p x_{ip} \\right)^2\n\\end{split}\n$$\n\nSum's aren't resistant to outliers!\n\n\n---\n\n## Types of outliers\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](10-mlr-diagnostics_files/figure-revealjs/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n## Outliers\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](10-mlr-diagnostics_files/figure-revealjs/unnamed-chunk-4-1.png){fig-align='center' width=864}\n:::\n:::\n\n\n- In higher dimensions, outliers can be tricky to detect\n\n- To detect outliers in X, you have to consider the multivariate relationships between all of the predictors\n\n---\n\n## Not all outliers are *influential*\n\n<font color=\"orange\">Orange line</font> = SLR with outlier; Black line = SLR without outlier\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](10-mlr-diagnostics_files/figure-revealjs/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n---\n\n## Influential points\n\nPoints that are able to substantially change the fitted model ares **influential**\n\n<br>\n\n. . .\n\nHow do we find outliers and determine if they are influential?\n\n- Plot the data\n- Plot the standardized residuals\n- Fit the model with/without the point(s)\n- Calculate to *influence diagnostics*\n\n\n\n\n\n---\n\n## Leverage {.smaller}\n\nMeasures the **potential to influence** the SLR line\n\n:::{.columns}\n::: {.column width=\"15%\"}\nFor SLR:\n:::\n::: {.column width=\"85%\"}\n$$h_i = \\frac{1}{n-1} \\left[ \\frac{x_i - \\overline{x}}{s_x} \\right]^2 + \\frac{1}{n} = \\dfrac{1}{n} + \\frac{\\left(x_i - \\overline{x}\\right)^2}{\\sum \\left(x_i - \\overline{x}\\right)^2}$$\n:::\n:::\n\n:::{.columns}\n::: {.column width=\"15%\"}\nFor MLR:\n:::\n::: {.column width=\"85%\"}\nmore complicated because we're looking at a distance of a case\nfrom the average of p predictors\n:::\n:::\n\n\n**Cutoff**\n\n- $2(p+1)/n$\n- $3(p+1)/n$\n- Also a good idea to examine a histogram/index plot\n\n::: footer\nI use p to denote the number of slope coefficients, so there are p+1\nregression coefficients\n:::\n\n---\n\n## Leverage\n\n\"Flares up\" when value of x is far from the mean\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](10-mlr-diagnostics_files/figure-revealjs/unnamed-chunk-7-1.png){width=960}\n:::\n:::\n\n\n## Leverage\n\nIn higher dimensions, leverage is focusing on the distance from the average of all of the predictors\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](10-mlr-diagnostics_files/figure-revealjs/unnamed-chunk-8-1.png){width=864}\n:::\n:::\n\n\n\n---\n\n## Standardized residuals {.smaller}\n\nStandardized residuals are calculated by dividing the residuals by their standard deviation\n\n$$r_i = \\frac{e_i}{\\widehat{\\sigma} \\sqrt{1 - \\dfrac{1}{n} - \\dfrac{(x_i - \\overline{x})^2}{\\sum (x_i - \\overline{x})^2}}} = \\dfrac{e_i}{ \\widehat{\\sigma} \\sqrt{1 - h_{i}}}$$\n\n\n<br>\n\n**Guidelines**: \n\n- $|r_i|>2$ for small data sets\n- $|r_i|>4$ for large data sets\n\n:::footer\nSleuth calls these (internally) studentized residuals while R calls these\nstandardized residuals\n:::\n\n---\n\n## Standardized residuals\n\n\"Flare up\" when value of y is far from $\\widehat{y}$\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](10-mlr-diagnostics_files/figure-revealjs/unnamed-chunk-9-1.png){width=960}\n:::\n:::\n\n\n## DFFITS {.smaller}\n\nMeasures effect the i<sup>th</sup> case has on its **own** fitted value\n\n\n$$DFFITS_i = \\frac{\\widehat{y}_i - \\widehat{y}_{i(i)}}{\\widehat{\\sigma}_{(i)} \\sqrt{h_i}}$$\nwhere the subscript $(i)$ indicates that the value is based on a model when observation i is omitted\n\n<br>\n\n**Cutoff**\n\n- 1 for small/medium data sets\n- $2\\sqrt{\\dfrac{p+1}{n}}$ for large data sets\n\n\n:::footer\nDFFITS is not discussed in *Sleuth*\n:::\n\n\n---\n\n## Cook's distance {.smaller}\n\nMeasures effect the i<sup>th</sup> case has on **all** of the fitted values\n\n$$D_i= \\sum_{j=1}^n\\frac{ \\left(\\widehat{y}_{j(i)} - \\widehat{y}_j \\right)^2}{(p+1) \\widehat{\\sigma}} = \\frac{r_i^2}{p+1} \\left( \\frac{h_i}{1-h_i} \\right)$$\n\nwhere $\\widehat{y}_{j(i)}$ is the fitted value for observation j based on a model when observation i is omitted\n\n\n<br>\n\n**Cutoff**\n\n- $D_i$ near or above 1 indicates large influence\n\n- Find what quantile of $F_{p+1, n-p-1}$ $D_i$ corresponds to, larger than 0.5 is cause for concern\n\n- Also can judge relative standing of  $D_i$ â€” make an index plot\n\n---\n\n## Cook's distance\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](10-mlr-diagnostics_files/figure-revealjs/unnamed-chunk-10-1.png){width=960}\n:::\n:::\n\n\n## Do we calculate these by hand?\n\nNo! \n\n- `augment()` from the `broom` package\n- `influence.measures()` from the `car` package\n\n\n## Advice from *Sleuth*\n\n![](images/sleuth_outlier_flowchart.png){fig-position=\"center\"}\n\n:::footer\nSource: Display 11.8 in *Sleuth* (3rd edition)\n:::\n",
    "supporting": [
      "10-mlr-diagnostics_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
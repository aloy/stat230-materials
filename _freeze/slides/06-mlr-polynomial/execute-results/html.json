{
  "hash": "cb76073b1158aa59e6b555525ddca20a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Polynomial Regression\"\nsubtitle: \"Stat 230: Applied Regression Analysis\"\nformat: \n  revealjs:\n    theme: [serif, styles.scss]\n    scrollable: true\neditor: source\neditor_options: \n  chunk_output_type: console\ncode-annotations: hover\n---\n\n\n\n# [PDF version of slides](pdf_slides/06-mlr-polynomial.pdf)\n\n## Wildfires\n\n- The National Interagency Coordination Center at the National Interagency Coordination Center compiles annual wildland fire statistics for federal and state agencies. \n\n- This information is provided through Situation Reports, which have been in use for several decades.\n\n- Our goal is to model the number of acres burned over the years\n\n\n::: footer\nData source: https://www.nifc.gov/fireInfo/fireInfo_stats_totalFires.html\n:::\n\n##\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](06-mlr-polynomial_files/figure-revealjs/unnamed-chunk-1-1.png){width=800}\n:::\n:::\n\n\n\n## Option 1: SLR model\n\n\n$\\mu \\lbrace y | x \\rbrace = \\beta_0 + \\beta_1 x$\n\nIs the fit reasonable?\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](06-mlr-polynomial_files/figure-revealjs/unnamed-chunk-2-1.png){width=864}\n:::\n:::\n\n\n\n## Option 2: Transform X\n\n\n$\\mu \\lbrace y | x \\rbrace = \\beta_0 + \\beta_1 x^2$\n\nIs the fit reasonable?\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](06-mlr-polynomial_files/figure-revealjs/unnamed-chunk-3-1.png){width=864}\n:::\n:::\n\n\n## Option 3: Polynomial model\n\n\n$\\mu \\lbrace y | x \\rbrace = \\beta_0 + \\beta_1 x + \\beta_2x^2$\n\nIs the fit reasonable?\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](06-mlr-polynomial_files/figure-revealjs/unnamed-chunk-4-1.png){width=864}\n:::\n:::\n\n\n\n## The polynomial regression model\n\n\n$$Y_i = \\beta_0 + \\beta_1 x_{i} + \\beta_2 x_{i}^2 + \\cdots + \\beta_k x_{i}^k + \\varepsilon_i, \\quad \\varepsilon_i \\overset{iid}{\\sim} N(0, \\sigma)$$\n\nAssumptions — same as in SLR\n\n1. $\\mu\\{Y|x_i\\}$, is a linear function\n\n1. For each $x_i$, the sub-population of responses is normally distributed \n\n1. The standard deviation for each sub-population is $\\sigma$\n\n1.  Independent observations\n\n\n## Interpreting the model\n\n::: columns\n:::{.column width=\"50%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](06-mlr-polynomial_files/figure-revealjs/unnamed-chunk-5-1.png){width=384}\n:::\n:::\n\n:::\n:::{.column width=\"50%\"}\nFocus on the expected change in $y$ for a specific one-unit increase in $x$\n\n- e.g. change in acres burned from 1985 to 1990\n    \n- e.g. change in acres burned from 2005 to 2010\n:::\n:::\n\n::: {style=\"font-size: 0.8em;\"}\n\\begin{aligned}\n\\mu\\{ y | x + 1 \\} - \\mu\\{ y | x \\} \n  &=  \\left[ \\beta_0 + \\beta_1 (x+1) + \\beta_2 (x+1)^2 \\right] - \\left[ \\beta_0 + \\beta_1 x + \\beta_2 x^2 \\right]\\\\\n  &= \\beta_1 + \\beta_2 \\left( 2x + 1 \\right)\n\\end{aligned}\n\n:::\n\n\n## Inferences about coefficients\n\nInference uses the same t-based tools as SLR, but with \n\n$$\\widehat{\\sigma}  = \\sqrt{\\dfrac{{\\sum_{i=1}^n e_i^2}}{n - (k+1)}}$$\n\ni.e. the degrees of freedom of the t-distribution change\n\n\n\n## Testing a single coefficient\n\n::: {style=\"font-size: 0.9em;\"}\n**Hypotheses:** $H_0: \\ \\beta_j = \\#$ vs. $H_a: \\ \\beta_j \\underset{>}{\\overset{<}{\\ne}} \\#$\n:::\n\n. . .\n\n::: {style=\"font-size: 0.9em;\"}\n**Test statistic:** $t = \\dfrac{\\hat{\\beta}_j - \\#}{SE(\\beta_j)}$\n:::\n. . .\n\n::: {style=\"font-size: 0.9em;\"}\n**Reference distribution:** $t$ distribution with d.f. = $n-(k+1)$\n\n\n**p-value:** Area in the tail(s) specified by $H_a$\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](06-mlr-polynomial_files/figure-revealjs/unnamed-chunk-6-1.png){width=850}\n:::\n:::\n\n\n## CIs for a single coefficient\n\n\n$\\widehat{\\beta}_j \\pm t^*_{n-(k+1)} \\cdot SE(\\widehat{\\beta}_j )$\n\n\n. . .\n\n<br>\n\n#### Wildfires example\n\n::: {style=\"font-size: 0.8em;\"}\n\n\n|Term        |    Estimate|         SE|      Lower|       Upper|\n|:-----------|-----------:|----------:|----------:|-----------:|\n|(Intercept) | 16109806404| 3793719340| 8510073345| 23709539462|\n|Year        |   -16264428|    3814896|  -23906583|    -8622273|\n|I(Year^2)   |        4106|        959|       2185|        6027|\n\n:::\n\n\n## Your turn\n\nWould a higher-order polynomial (e.g. cubic, quartic, quintic) provide a better fit to the wildfire data?\n\n<br>\n\nWork through that example on the handout with your neighbors\n\n\n## A warning about this analysis\n\n\n> Prior to 1983, sources of these figures are not known, or cannot be confirmed, and were not derived from the current situation reporting process. As a result the figures prior to 1983 should not be compared to later data.\n>\n>— NIFC\n\n::: footer\nhttps://www.nifc.gov/fireInfo/fireInfo_stats_totalFires.html]\n:::\n\n\n## A warning about polynomials\n\n\nHigh-order polynomial regression models will over-fit your data (i.e. pick up on peculiarities specific to your one sample from the population)\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](06-mlr-polynomial_files/figure-revealjs/unnamed-chunk-8-1.png){width=850}\n:::\n:::\n\n\n\n## Multiple linear regression\n\n\nPolynomial regression is one example of the multiple regression model, but there are numerous ways to incorporate multiple predictors into a model\n\n$\\mu \\lbrace Y | X \\rbrace = \\beta_0 + \\beta_1 x + \\beta_2 x^2$\n\n. . .\n\n$\\mu \\lbrace Y | X \\rbrace = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2$\n\n. . .\n\n\n$\\mu \\lbrace Y | X \\rbrace = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\beta_2 x_1 x_2$\n\n\n# Explained variance\n\n\n\n## The \"null\" model\n\n- Use the mean of Y as the prediction for all observations\n\n- $\\mu \\lbrace Y | X \\rbrace = \\beta_0$\n\n- Leaves a lot of variability unexplained\n\n::: columns\n:::{.column width=\"50%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06-mlr-polynomial_files/figure-revealjs/unnamed-chunk-9-1.png){fig-align='center' width=90%}\n:::\n:::\n\n:::\n:::{.column width=\"50%\"}\n$SD(Y) = 2.465548\\times 10^{6}$ cm\n:::\n:::\n\n## Polynomial model\n\n- $\\mu \\lbrace Y | X \\rbrace = \\beta_0 + \\beta_1x + \\beta_2 x^2$\n\n- Using a predictor explains more variability\n\n<br>\n\n\n::: columns\n:::{.column width=\"50%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06-mlr-polynomial_files/figure-revealjs/unnamed-chunk-10-1.png){fig-align='center' width=90%}\n:::\n:::\n\n:::\n:::{.column width=\"50%\"}\n$SD(Y) = 1.9098377\\times 10^{6}$ cm\n:::\n:::\n\n\n\n## SSTotal\n\n::: columns\n:::{.column width=\"50%\"}\n${\\rm SSTotal} = \\sum(Y_i - \\bar{Y})^2$\n\nMeasures the overall variability in $Y$\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06-mlr-polynomial_files/figure-revealjs/unnamed-chunk-11-1.png){fig-align='center' width=360}\n:::\n:::\n\n:::\n:::\n\n\n## SSResidual (aka SSError)\n\n::: columns\n::: {.column width=\"50%\"}\n${\\rm SSResidual} = \\sum(Y_i - \\widehat{Y}_i)^2$\n\nMeasures the variability unexplained by the model\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06-mlr-polynomial_files/figure-revealjs/unnamed-chunk-12-1.png){fig-align='center' width=360}\n:::\n:::\n\n:::\n:::\n\n\n## SSRegression\n\nMeasures the variability explained by the model\n\n<br>\n\n::: columns\n:::{.column width=\"30%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](06-mlr-polynomial_files/figure-revealjs/unnamed-chunk-13-1.png){width=100%}\n:::\n:::\n\n:::\n:::{.column width=\"70%\"}\n<br>\n\n<br>\n\n<br>\n\n${\\rm SSRegression} = SSTotal - SSError$\n:::\n:::\n\n## Coefficient of Determination: R<sup>2</sup>\n\nProportion of the total variation in $y$ explained by the linear regression model\n\n::: columns\n:::{.column width=\"30%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](06-mlr-polynomial_files/figure-revealjs/unnamed-chunk-14-1.png){width=100%}\n:::\n:::\n\n:::\n:::{.column width=\"70%\"}\n<br>\n\n<br>\n\n\n\n$\\begin{split}\nR^2 &= 0.421\\\\\n&= \\dfrac{SSRegr}{SST} \\\\\n&= 1 - \\dfrac{SSE}{SST} \n\\end{split}$\n:::\n:::\n\n\n## ⚠️ Caution {.center}\n\n$R^2$ only addresses how close the fitted values are to the data, on average. It says nothing about the validity of the model.\n\n\n# Comparing models\n\n\n## Wildfires example\n\nSuppose we wish to compare a quadratic and quartic model for the wildfires data set:\n\n- Quadratic: $\\mu \\lbrace Y | X \\rbrace = \\beta_0 + \\beta_1 x + \\beta_2 x^2$\n- Quartic: $\\mu \\lbrace Y | X \\rbrace = \\beta_0 + \\beta_1 x + \\beta_2 x^2 + \\beta_3 x^3 + \\beta_4 x^4$\n\nHow do we decide which model is preferred?\n\n\n::: {.cell}\n\n:::\n\n\n\n\n\n\n## Comparing models\n\nCan we compare $R^2$ values?\n\n- No! More complex models will always have a higher $R^2$ value, even if the additional predictors are not useful.\n\n\nCan we run individual t-tests?\n\n- No! The tests are not necessarily independent, and the Type I error rate will be inflated.\n\n## Comparing models with an F-test\n\n:::: {.columns align=center}\n::: {.column width=\"25%\"}\nFull model\n:::\n\n::: {.column width=\"70%\"}\n$\\mu \\lbrace Y | X \\rbrace = \\beta_0 + \\beta_1 x + \\beta_2 x^2 + \\beta_3 x^3 + \\beta_4 x^4$\n:::\n\n::: {.column width=\"25%\"}\nReduced model\n:::\n\n::: {.column width=\"70%\"}\n$\\mu \\lbrace Y | X \\rbrace = \\beta_0 + \\beta_1 x + \\beta_2 x^2$\n:::\n\n::::\n\n. . .\n\n<br>\n\n\n:::: {.columns align=center}\n::: {.column width=\"25%\"}\nHypotheses\n:::\n\n::: {.column width=\"70%\"}\n$H_0:\\ \\beta_{3} = \\beta_4 = 0$\n\n$H_a:$ at least one $\\beta_j \\ne 0$, $j=3,4$\n:::\n\n::::\n\n## Comparing models with an F-test\n\n\n\nTest statistic\n\n\n$$\n\\begin{split}\nF &= \\frac{(R^2_{\\text{full}} - R^2_{\\text{reduced}}) / d}{(1 - R^2_{\\text{full}}) / df_{\\text{full}}}\\\\\n&= \\frac{(\\text{SSR}_{\\text{full}} - \\text{SSR}_{\\text{reduced}}) / d}{\\text{MSE}_{\\text{full}}}\\\\\n&= \\frac{(\\text{SSE}_{\\text{reduced}} - \\text{SSE}_{\\text{full}}) / d}{\\text{MSE}_{\\text{full}}}\n\\end{split}\n$$\n\nwhere \n\n- $d = \\text{df}_{full} - \\text{df}_{reduced}$ = \\# betas being tested\n- $\\text{df}_{i} = n - (p + 1)=$ error d.f. for model $i$\n- $\\text{MSE}_{\\text{full}} = \\dfrac{\\text{SSE}_{\\text{full}}}{\\text{df}_{\\text{full}}}$\n\n\n\n## F distribution\n\n\nThe F-statistics follows an $F$ distribution with $\\text{df}_{full} - \\text{df}_{reduced}$ and $n-p-1$ d.f.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06-mlr-polynomial_files/figure-revealjs/unnamed-chunk-16-1.png){fig-align='center' width=480}\n:::\n:::\n\n\n\n\n## Upper-tail p-values\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06-mlr-polynomial_files/figure-revealjs/unnamed-chunk-18-1.png){fig-align='center' width=480}\n:::\n:::\n\n\n\nTo obtain upper-tail areas: `1 - pf(stat, df1, df2)`\n\n\n## Putting it all together\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|model   | r.squared| df| df.residual| nobs|\n|:-------|---------:|--:|-----------:|----:|\n|Full    |     0.453|  4|          54|   59|\n|Reduced |     0.421|  2|          56|   59|\n\n\n:::\n:::\n\n\n. . .\n\n$$\nF = \\frac{(R^2_{\\text{full}} - R^2_{\\text{reduced}}) / d}{(1 - R^2_{\\text{full}}) / df_{\\text{full}}} = \\frac{(0.453 - 0.421) / 2}{(1 - 0.453) / 54} \\approx 1.58\n$$\n\n. . .\n\n\n::: {.cell}\n\n```{.r .cell-code}\n1 - pf(1.58, 2, 54)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.2153484\n```\n\n\n:::\n:::\n\n\n. . .\n\nThere is no evidence that the quartic model is an improvement over the quadratic model ($F=4.467$, $df = 2, 54$, $p = 0.215$).\n\n\n## Reading R output\n\n```\nCall:\nlm(formula = Acres ~ poly(Year, 4), data = wildfires)\n\nCoefficients:\n               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)     4641410     245955  18.871  < 2e-16 ***\npoly(Year, 4)1  9025270    1889218   4.777 1.40e-05 ***\npoly(Year, 4)2  8177004    1889218   4.328 6.55e-05 ***\npoly(Year, 4)3 -1194695    1889218  -0.632   0.5298    \npoly(Year, 4)4 -3177711    1889218  -1.682   0.0983 .  \n\nResidual standard error: 1889000 on 54 degrees of freedom\nMultiple R-squared:  0.4534,\tAdjusted R-squared:  0.4129 \nF-statistic:  11.2 on 4 and 54 DF,  p-value: 1.096e-06\n```\n\n\n::: footer\nOutput was edited to fit on one slide\n:::\n\n\n## Extra sums of squares F-test in R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfull <- lm(Acres ~ poly(Year, 4), data = wildfires)    #<1>\nreduced <- lm(Acres ~ poly(Year, 2), data = wildfires) #<2>\nanova(reduced, full) #<3>\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nModel 1: Acres ~ poly(Year, 2)\nModel 2: Acres ~ poly(Year, 4)\n  Res.Df        RSS Df  Sum of Sq      F Pr(>F)\n1     56 2.0426e+14                            \n2     54 1.9273e+14  2 1.1525e+13 1.6146 0.2084\n```\n\n\n:::\n:::\n\n\n1. Fit the full model\n2. Fit the reduced model\n3. Use `anova()` to compare the two models. The first argument should be the reduced model.\n",
    "supporting": [
      "06-mlr-polynomial_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
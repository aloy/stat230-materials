{
  "hash": "5e961ece475275e82913b67227702682",
  "result": {
    "markdown": "---\ntitle: \"Using a regression model to compare means\"\nsubtitle: \"Making connections\"\nauthor: \"Stat 230\"\nformat: \n  revealjs:\n    chalkboard: \n      buttons: false\neditor: source\n---\n\n\n\n\n## Simple linear regression model\n\n**observed response = signal + noise** <br>\n\n$y_i = \\beta_0 + \\beta_1 x_i + \\varepsilon_i$ where $\\varepsilon_i \\overset{\\rm iid}{\\sim} \\mathcal{N} (0, \\sigma^2)$\n\n. . .\n\nThis model requires\n\n-   Linear relationship between $x$ and $y$\n\n-   Errors are independent and identically distributed (iid)\n\n-   Errors follow normal distribution\n\n-   Errors have mean 0\n\n-   Variance of the errors don't depend on $x$\n\n## Indicator/dummy variables\n\nHow can we use a categorical explanatory variable in a regression model?\n\n. . .\n\n-   Create an indicator variable that takes on either 0 or 1\n\n. . .\n\n-   Disciplinary area of textbook -- STEM vs. Social sciences\n\n    -   $x_{\\rm social} = 0$ if a book is STEM\n\n    -   $x_{\\rm social} = 1$ if a book is social science\n\n## Regression model with indicator\n\nWe can rewrite the two-sample t-test as a regression model using an indicator\n\n\n$$y_i = \\beta_0 + \\beta_1 x_{\\rm social\\ i} + \\varepsilon_i$$\n\n\n. . .\n\nbut... we need to be careful with our interpretations of the regression coefficients!\n\n## Review: Interpretations\n\n::: columns\n::: {.column width=\"10%\"}\n$\\beta_0$\n:::\n\n::: {.column width=\"90%\"}\n-   y-intercept\n-   expected value of $y$ when $x=0$\n:::\n:::\n\n<br>\n\n. . .\n\n::: columns\n::: {.column width=\"10%\"}\n$\\beta_1$\n:::\n\n::: {.column width=\"90%\"}\n-   slope\n-   expected change in $y$ when $x$ increases by one unit\n:::\n:::\n\n## Interpretations\n\n$y_i = \\beta_0 + \\beta_1 x_{\\rm social\\ i} + \\varepsilon_i$\n\n<br>\n\n::: columns\n::: {.column width=\"10%\"}\n$\\beta_0$\n:::\n\n::: {.column width=\"90%\"}\n-   y-intercept\n-   expected value of $y$ when $x=0$\n-   If $x_{\\rm social}=0$, the book is for a STEM course (i.e., baseline group)\n-   $\\beta_0 =$ mean textbook price for STEM courses\n:::\n:::\n\n## Interpretations\n\n$y_i = \\beta_0 + \\beta_1 x_{\\rm social\\ i} + \\varepsilon_i$\n\n<br>\n\n$\\mu_{\\rm social} = \\beta_0 + \\beta_1 \\Longleftrightarrow \\beta_0 + \\beta_1(1)$\n\n-   If $x_{\\rm social}=1$, the book is for a social science course\n-   Linear equation gives the mean (expected) response\n\n## Interpretations\n\n$y_i = \\beta_0 + \\beta_1 x_{\\rm social\\ i} + \\varepsilon_i$\n\n<br>\n\n$\\beta_1 = \\mu_{\\rm social} - \\mu_{\\rm STEM}$\n\n-   $\\mu_{\\rm STEM} = \\beta_0$\n-   $\\mu_{\\rm social} = \\beta_0 + \\beta_1$\n-   expected difference in mean response for social science books compared to STEM books\n\n## Fitting the model\n\n::: columns\n::: {.column width=\"30%\"}\n**Model**\n:::\n\n::: {.column width=\"70%\"}\n$y_i = \\beta_0 + \\beta_1 x_{i} + \\varepsilon_i$, $\\qquad \\varepsilon_i \\overset{\\rm iid}{\\sim} \\mathcal{N} (0, \\sigma^2)$\n:::\n:::\n\n<br>\n\n::: columns\n::: {.column width=\"30%\"}\n**Problem**\n:::\n\n::: {.column width=\"70%\"}\nWe need estimates for $\\beta_0$, $\\beta_1$, and $\\sigma^2$\n:::\n:::\n\n<br>\n\n. . .\n\n::: columns\n::: {.column width=\"30%\"}\n**Procedure**\n:::\n\n::: {.column width=\"70%\"}\n-   Find $\\widehat{\\beta}_0$ and $\\widehat{\\beta}_1$ that minimize\n\n    $\\sum_{i=1}^n \\left(y_i - (\\widehat{\\beta}_0 + \\widehat{\\beta}_1 x_i )\\right)^2 = \\text{SSR}$\n\n-   Use SSR as basis for $\\widehat{\\sigma}^2$\n:::\n:::\n\n## Least squares estimates\n\n\n$$\\begin{align}\n\\widehat{\\beta}_0 &= \\overline{y} - \\widehat{\\beta}_1 \\overline{x}\\\\\n& \\\\\n\\widehat{\\beta}_1 &= \\dfrac{\\displaystyle \\sum_{i=1}^n \\left(y_i - \\overline{y} \\right) \\left(x_i - \\overline{x} \\right)}{\\displaystyle \\sum_{i=1}^n \\left(x_i - \\overline{x} \\right)^2} = r \\dfrac{s_y}{s_x}\n\\end{align}$$\n\n::: aside\nIt's common to use $b_0 = \\widehat{\\beta}_0$ and $b_1 = \\widehat{\\beta}_1$. Recall that $r$ is the correlation between $x$ and $y$.\n:::\n\n## Estimated residual variance\n\nTo obtain an estimate of $\\sigma^2$, we use the sum of the squared errors\n\n$$\\widehat{\\sigma}^2 = \\displaystyle \\dfrac{\\sum_{i=1}^n (y_i - \\widehat{y}_i)^2}{n - 2} = \\displaystyle \\dfrac{\\text{SSR}}{n-2}$$ <br>\n\n\nwhere $\\widehat{y}_i = \\widehat{\\beta}_0 + \\widehat{\\beta}_1 x_i$\n\n## Regression output\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"|10-11,15\"}\nCall:\nlm(formula = Price ~ Area, data = BookPrices)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-87.990 -39.972   4.138  40.359 110.010 \n\nCoefficients:\n                    Estimate Std. Error t value Pr(>|t|)    \n(Intercept)           156.73      10.40  15.075  < 2e-16 ***\nAreaSocial Sciences   -57.74      16.73  -3.452  0.00128 ** \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nResidual standard error: 54.03 on 42 degrees of freedom\nMultiple R-squared:  0.221,\tAdjusted R-squared:  0.2025 \nF-statistic: 11.92 on 1 and 42 DF,  p-value: 0.001281\n```\n:::\n\n\n::: aside\nThe residual standard error is $\\widehat{\\sigma}$\n:::\n\n# Connecting two-sample t-procedures to regression\n\n## Hypothesis tests {.smaller}\n\n::: columns\n::: {.column width=\"20%\"}\n<br>\n\nNull hypothesis\n:::\n\n::: {.column width=\"40%\"}\n**t-test**\n\n$H_0: \\mu_1 - \\mu_2 = 0$\n:::\n\n::: {.column width=\"40%\"}\n**Regression**\n\n$H_0: \\beta_1 = 0$\n:::\n:::\n\n<br>\n\n. . .\n\n::: columns\n::: {.column width=\"20%\"}\nTest statistic\n:::\n\n::: {.column width=\"40%\"}\n$t=\\dfrac{(\\bar{y}_1- \\bar{y}_2) - 0}{s_p \\sqrt{\\frac{1}{n_1} + \\frac{1}{n_2}}}$\n:::\n\n::: {.column width=\"40%\"}\n$t = \\dfrac{\\widehat{\\beta}_1 - 0}{SE(\\widehat{\\beta}_1)}$, where $SE(\\widehat{\\beta}_1) = \\widehat{\\sigma} \\sqrt{\\dfrac{1}{\\sqrt{\\sum_{i=1}^n \\left(x_i - \\overline{x} \\right)^2}}}$\n:::\n:::\n\n<br>\n\n. . .\n\n::: columns\n::: {.column width=\"20%\"}\nNull distribution\n:::\n\n::: {.column width=\"40%\"}\n$t_{n_1 + n_2 - 2}$\n:::\n\n::: {.column width=\"40%\"}\n$t_{n - 2}$\n:::\n:::\n\n## Confidence intervals\n\nGeneral formula: $\\rm statistic \\pm q^* \\times SE$\n\n::: columns\n::: {.column width=\"20%\"}\n:::\n\n::: {.column width=\"40%\"}\n**SE**\n:::\n\n::: {.column width=\"40%\"}\n**Sampling distribution**\n:::\n:::\n\n<br>\n\n. . .\n\n::: columns\n::: {.column width=\"20%\"}\nt-test\n:::\n\n::: {.column width=\"40%\"}\n$s_p \\sqrt{\\frac{1}{n_1} + \\frac{1}{n_2}}$\n:::\n\n::: {.column width=\"40%\"}\n$t_{n_1 + n_2 - 2}$\n:::\n:::\n\n<br>\n\n. . .\n\n::: columns\n::: {.column width=\"20%\"}\nRegression slope\n:::\n\n::: {.column width=\"40%\"}\n$\\widehat{\\sigma} \\sqrt{\\frac{1}{\\sqrt{\\sum_{i=1}^n \\left(x_i - \\overline{x} \\right)^2}}}$\n:::\n\n::: {.column width=\"40%\"}\n$t_{n - 2}$\n:::\n:::\n\n# We'll use R to implement inference, and we'll explore this in class {.r-fit-text}\n",
    "supporting": [
      "03-2sample-regression_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    function fireSlideChanged(previousSlide, currentSlide) {\n\n      // dispatch for htmlwidgets\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for reveal\n    if (window.Reveal) {\n      window.Reveal.addEventListener(\"slidechanged\", function(event) {\n        fireSlideChanged(event.previousSlide, event.currentSlide);\n      });\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}
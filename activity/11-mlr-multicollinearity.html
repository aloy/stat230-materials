<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Regression Cautions: Multicollinearity and R2 – Stat 230 - Fall 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-533b9ae3c010999c496e3372658dddf2.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="quarto-light">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#example-1-uncorrelated-predictors" id="toc-example-1-uncorrelated-predictors" class="nav-link" data-scroll-target="#example-1-uncorrelated-predictors">Example 1: Uncorrelated Predictors</a></li>
  <li><a href="#example-2-prefectly-correlated-predictors" id="toc-example-2-prefectly-correlated-predictors" class="nav-link" data-scroll-target="#example-2-prefectly-correlated-predictors">Example 2: Prefectly Correlated Predictors</a></li>
  <li><a href="#example-3-a-more-realistic-example" id="toc-example-3-a-more-realistic-example" class="nav-link" data-scroll-target="#example-3-a-more-realistic-example">Example 3: A more realistic example</a></li>
  <li><a href="#what-about-predictions" id="toc-what-about-predictions" class="nav-link" data-scroll-target="#what-about-predictions">What about predictions?</a></li>
  <li><a href="#be-wary-of-r2-when-comparing-models" id="toc-be-wary-of-r2-when-comparing-models" class="nav-link" data-scroll-target="#be-wary-of-r2-when-comparing-models">Be Wary of R<sup>2</sup> when comparing models</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Regression Cautions: Multicollinearity and R<sup>2</sup></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>In this activity you will learn how to calculate diagnostic measures and create diagnostic plots for multiple linear regression models in R.</p>
</section>
<section id="example-1-uncorrelated-predictors" class="level2">
<h2 class="anchored" data-anchor-id="example-1-uncorrelated-predictors">Example 1: Uncorrelated Predictors</h2>
<p>As a first example, let’s consider a multiple linear regression model where the two predictor variables are uncorrelated.</p>
<p><strong>Task 1.</strong> Inspect the below correlation matrix and verify that the correlation between the two predictor variables (<code>x1</code> and <code>x2</code>) is 0.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>          x1        x2         y
x1 1.0000000 0.0000000 0.7419309
x2 0.0000000 1.0000000 0.6384057
y  0.7419309 0.6384057 1.0000000</code></pre>
</div>
</div>
<p><strong>Task 2.</strong> The below code chunk fits a simple linear regression model with <code>y</code> as the response variable and <code>x1</code> as the predictor variables. The coefficients table was extract using the <code>broom::tidy()</code>. (Feel free to use <code>broom::tidy()</code> it in your work!)</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1, <span class="at">data =</span> ex1)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(mod1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)    23.5      10.1       2.32  0.0591
2 x1              5.37      1.98      2.71  0.0351</code></pre>
</div>
</div>
<p>Similarly, here is the output for the simple linear regression model with <code>y</code> as the response variable and <code>x2</code> as the predictor variable.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)    23.5      10.1       2.32  0.0591
2 x1              5.37      1.98      2.71  0.0351</code></pre>
</div>
</div>
<p>And finally, here is the output for the multiple linear regression model with <code>y</code> as the response variable and both <code>x1</code> and <code>x2</code> as the predictor variables.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)    0.375     4.74     0.0791 0.940   
2 x1             5.37      0.664    8.10   0.000466
3 x2             9.25      1.33     6.97   0.000937</code></pre>
</div>
</div>
<p>Compare the model summaries from the three models. What do you observe about the coefficients when both predictors are included in the model? What do you observe about the standard errors? The results of the hypothesis tests?</p>
</section>
<section id="example-2-prefectly-correlated-predictors" class="level2">
<h2 class="anchored" data-anchor-id="example-2-prefectly-correlated-predictors">Example 2: Prefectly Correlated Predictors</h2>
<p>In many examples the predictor variables will be correlated. As an extreme example, let’s consider a situation where the predictors are perfectly correlated. The data set for this small example is printed below.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  x1 x2   y
1  2  6  23
2  8  9  83
3  6  8  63
4 10 10 103</code></pre>
</div>
</div>
<p><strong>Task 3.</strong> Inspect the below correlation matrix and verify that the correlation between the two predictor variables (<code>x1</code> and <code>x2</code>) is 1.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   x1 x2 y
x1  1  1 1
x2  1  1 1
y   1  1 1</code></pre>
</div>
</div>
<p><strong>Task 4.</strong> From the previous task, you should have seen that the correlation between <code>x1</code> and <code>x2</code> is 1, as is the correlation between both predictors and <code>y</code>. This sounds like a great situation, right? We’ll explore two models to unpack this.</p>
<ol type="a">
<li><p>Consider the fitted regression equation: <span class="math inline">\(\widehat{y} = -87 + x_1 + 18x_2\)</span>. Verify that the predicted values are exactly equal to the observed values.</p></li>
<li><p>Consider the fitted regression equation: <span class="math inline">\(\widehat{y} = -7 + 9x_1 + 2x_2\)</span>. Verify that the predicted values are exactly equal to the observed values.</p></li>
<li><p>Discuss the following questions with your group:</p>
<ul>
<li>Would you be willing to use either model to make predictions for new observations? Why or why not?</li>
<li>Would you be willing to interpret the coefficients in either model? Why or why not?</li>
<li>Do you think the standard error of the slopes is reasonably small or large? Why?</li>
</ul></li>
</ol>
</section>
<section id="example-3-a-more-realistic-example" class="level2">
<h2 class="anchored" data-anchor-id="example-3-a-more-realistic-example">Example 3: A more realistic example</h2>
<p>Let’s consider a more realistic example where the predictor variables are correlated, but not perfectly correlated. The data set <code>bodyfat</code> contains measurements on 20 healthy adults between 25 and 34 years of age. We’re interested in predicting body fat percentage using three body measurements: triceps skinfold thickness, thigh circumference, and midarm circumference.</p>
<p><strong>Task 5.</strong> Below is the correlation matrix for the data set. What do you observe about the correlations between the predictor variables?</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                     triceps_skinfold thigh_circumference midarm_circumference
triceps_skinfold            1.0000000           0.9238425            0.4577772
thigh_circumference         0.9238425           1.0000000            0.0846675
midarm_circumference        0.4577772           0.0846675            1.0000000
body_fat                    0.8432654           0.8780896            0.1424440
                      body_fat
triceps_skinfold     0.8432654
thigh_circumference  0.8780896
midarm_circumference 0.1424440
body_fat             1.0000000</code></pre>
</div>
</div>
<p><strong>Task 6.</strong> There are numerous models that we could consider. Below are summary tables from several models. Compare the model summaries from the fitted models. What do you observe about the coefficients when different predictors are included in the model? What do you observe about the standard errors? The results of the hypothesis tests?</p>
<p>Only triceps skinfold as a predictor:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term             estimate std.error statistic    p.value
  &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
1 (Intercept)        -1.50      3.32     -0.451 0.658     
2 triceps_skinfold    0.857     0.129     6.66  0.00000302</code></pre>
</div>
</div>
<p>Only thigh circumference as a predictor:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term                estimate std.error statistic     p.value
  &lt;chr&gt;                  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
1 (Intercept)          -23.6       5.66      -4.18 0.000566   
2 thigh_circumference    0.857     0.110      7.79 0.000000360</code></pre>
</div>
</div>
<p>Only midarm circumference as a predictor:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term                 estimate std.error statistic p.value
  &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)            14.7       9.10      1.61    0.124
2 midarm_circumference    0.199     0.327     0.611   0.549</code></pre>
</div>
</div>
<p>Triceps skinfold and thigh circumference as predictors:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  term                estimate std.error statistic p.value
  &lt;chr&gt;                  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)          -19.2       8.36     -2.29   0.0348
2 triceps_skinfold       0.222     0.303     0.733  0.474 
3 thigh_circumference    0.659     0.291     2.26   0.0369</code></pre>
</div>
</div>
<p>Triceps skinfold and midarm circumference as predictors:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  term                 estimate std.error statistic     p.value
  &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
1 (Intercept)          -26.0        7.00     -3.72  0.00172    
2 midarm_circumference   0.0960     0.161     0.595 0.560      
3 thigh_circumference    0.851      0.112     7.57  0.000000772</code></pre>
</div>
</div>
<p>Thigh circumference and midarm circumference as predictors:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  term                 estimate std.error statistic p.value
  &lt;chr&gt;                   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)            117.       99.8       1.17   0.258
2 triceps_skinfold         4.33      3.02      1.44   0.170
3 thigh_circumference     -2.86      2.58     -1.11   0.285
4 midarm_circumference    -2.19      1.60     -1.37   0.190</code></pre>
</div>
</div>
<p><i class="bi bi-sign-stop-fill"></i> Let me know when you have reached this spot. We’ll regroup as a class to discuss your observations.</p>
</section>
<section id="what-about-predictions" class="level2">
<h2 class="anchored" data-anchor-id="what-about-predictions">What about predictions?</h2>
<p>Now that we’ve discussed the issues revolving around interpreting coefficients and drawing inference on them in the presence of multicollinearity, let’s consider how multicollinearity impacts predictions.</p>
<p>Recall that the mean squared error (MSE) of a model measures the variability in the error terms (residuals). In other words, it is measuring the variability unexplained by the model.</p>
<p><strong>Task 7.</strong> Below are the MSE values for three of the models we considered in Task 6. What do you observe about the MSE values when different predictors are included in the model?</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Predictors</th>
<th>MSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>triceps_skinfold</td>
<td>7.95</td>
</tr>
<tr class="even">
<td>triceps_skinfold, thigh_circumference</td>
<td>6.47</td>
</tr>
<tr class="odd">
<td>triceps_skinfold, thigh_circumference, midarm_circumference</td>
<td>6.15</td>
</tr>
</tbody>
</table>
<p><strong>Task 8.</strong> Based on your observations, do you think we can use any of the models to make predictions for new observations? Why or why not?</p>
<p><i class="bi bi-sign-stop-fill"></i> Let me know when you have reached this spot. We’ll regroup as a class to discuss your observations.</p>
</section>
<section id="be-wary-of-r2-when-comparing-models" class="level2">
<h2 class="anchored" data-anchor-id="be-wary-of-r2-when-comparing-models">Be Wary of R<sup>2</sup> when comparing models</h2>
<p>We all love R<sup>2</sup> right? It is “easy” to interpret and is a popular metric of model fit to report in many fields. While I agree that R<sup>2</sup> is a nice metric for describing a <strong>single</strong> model, it has an issue when it’s used to compare models. In this example, you’ll explore this issue.</p>
<p>Case Study 10.1.1 in <em>The Statistical Sleuth</em> describes Galileo’s experiment that led him to discover that the trajectory of a body falling with horizontal velocity is a parabola (see page 272). The <code>case1011</code> data set in the <code>Sleuth3</code> R package contains the results of Galileo’s experiment. The data set contains seven observations on the following two variables: the horizontal distance traveled from the edge of the table to its landing spot, and the initial height of the object. Both measurements are in punti (1 punti = or 169/180 mm or about 0.037 in).</p>
<p><strong>Task 9.</strong> Fit each of the following models and report the R<sup>2</sup> value for each. Fill in the table below.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>R<sup>2</sup></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\text{distance} \sim \text{height}\)</span></td>
<td></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\text{distance} \sim \text{height} + \text{height}^2\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\text{distance} \sim \text{height} + \text{height}^2 + \text{height}^3\)</span></td>
<td></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\text{distance} \sim \text{height} + \text{height}^2 + \text{height}^3 + \text{height}^4\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\text{distance} \sim \text{height} + \text{height}^2 + \text{height}^3 + \text{height}^4 + \text{height}^5\)</span></td>
<td></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\text{distance} \sim \text{height} + \text{height}^2 + \text{height}^3 + \text{height}^4 + \text{height}^5+ \text{height}^6\)</span></td>
<td></td>
</tr>
</tbody>
</table>
<p>What do you observe about the R<sup>2</sup> values as you add more polynomial terms to the model?</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/aloy\.github\.io\/stat230-materials\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>